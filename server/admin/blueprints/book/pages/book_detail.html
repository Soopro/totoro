{% extends "layout.html" %}
{% set page_title = 'User' %}
{% set active_nav = 'user' %}

{% block body %}
<section class="container">
  <a class="btn btn-default"
     href="{{url_for('.deleted') if user.deleted else url_for('.index')}}">
    <span class="glyphicon glyphicon-menu-left"></span>
    Back
  </a>
  <hr>
  <div class="row">
    <!-- profile -->
    <form class="col-md-6"
          action="{{url_for('.update', user_id=user._id)
                    if user._id else url_for('.create')}}"
          method="POST">
      <h3>Profile</h3>
      <br>

      <!-- <div class="form-group">
        <label>Login</label>
        <input class="form-control"
               type="email"
               name="login"
               {{'disabled' if user.login}}
               value="{{user.login}}"
               required />
      </div>
      <div class="form-group">
        <label>Username</label>
        <input class="form-control"
               type="text"
               name="slug"
               {{'disabled' if user.slug}}
               value="{{user.slug}}"
               required />
      </div>

      <div class="form-group">
        <label>Password</label>
        <input class="form-control"
               type="text"
               name="passwd"
               value="{{'123456' if not user.password_hash}}"/>
      </div> -->

      {% if user.supervisor %}
      <span class="glyphicon glyphicon-king"></span>
      {% endif %}

      <div class="form-group">
        <label>Name</label>
        <input class="form-control"
               type="text"
               name="name"
               value="{{user.meta.name}}" />
      </div>
      <div class="form-group">
        <label>
          <input type="checkbox" {{'checked' if user.supervisor}}
                 name="supervisor"> as Supervisor?
        </label>
      </div>

      {% if user._id %}
      <div>
        <h5>Verification:</h5>
        <p>{{user.verified}}</p>
      </div>
      <div>
        <h5>Gender:</h5>
        <p>{{user.gender}}</p>
      </div>
      <div>
        <h5>Country:</h5>
        <p>{{user.country}}</p>
      </div>
      <div>
        <h5>Contact:</h5>
        <p>{{user.meta.wechat or user.meta.qq or user.meta.email}}</p>
      </div>
      {% endif %}

      <div class="form-group">
        <h5>Status</h5>
        {% for st in allowed_status %}
        <div class="radio-inline">
          <label>
            <input type="radio"
                   name="status"
                   value="{{st.key}}"
                   {{'checked' if user.status == st.key}}> {{st.text}}
          </label>
        </div>
        {% endfor %}
      </div>

      {% if user.creation %}
      <div>
        <h5>Registered at:</h5>
        <p>
         {{user.creation|dateformat}}
        </p>
      </div>
      {% endif %}

      <hr>
      <div class="row">
        <div class="col-md-6">
          <button class="btn btn-primary">
            <span class="glyphicon glyphicon-disk"></span>
            Save
          </button>
        </div>
        {% if user._id %}
        <div class="col-md-6">
          <a class="btn btn-danger"
             href="{{url_for('.remove', user_id=user._id)}}">
            <span class="glyphicon glyphicon-trash"></span>
            Delete
          </a>
        </div>
        {% endif %}
      </div>

    </form>

    <!-- verification -->
    {% if user._id %}
    <form class="col-md-6"
          action="{{url_for('.verify', user_id=user._id)}}"
          method="POST">
      <h3>Verification</h3>
      <br>
      <div class="form-group">
        <label>Real Name</label>
        <input class="form-control"
               type="text"
               name="name"
               value="{{verification.name}}"
               required />
      </div>

      <div class="form-group">
        <label>Country Code</label>
        <input class="form-control"
               type="text"
               name="country_code"
               value="{{verification.country_code or 'CN'}}"
               required />
      </div>

      <div class="form-group">
        <label>Mobile</label>
        <input class="form-control"
               type="text"
               name="number"
               value="{{verification.mobile}}" />
      </div>

      <div class="form-group">
        <h5>Status</h5>
        <div class="radio-inline">
          <label>
            <input type="radio"
                   name="status"
                   value="0"
                   {{'checked' if verification.status == 0}}> Pending
          </label>
        </div>
        <div class="radio-inline">
          <label>
            <input type="radio"
                   name="status"
                   value="1"
                   {{'checked' if verification.status == 1}}> Passed
          </label>
        </div>
      </div>

      <hr>
      <div class="row">
        <div class="col-md-6">
          <button class="btn btn-primary">
            <span class="glyphicon glyphicon-disk"></span>
            Verify
          </button>
        </div>
      </div>
    </form>
    {% endif %}
  </div>
  <br><br>

</section>

{% endblock %}
